(("undefined"!==typeof self?self:this)["webpackJsonpakri_dashboard_extension_0_1_0"]=("undefined"!==typeof self?self:this)["webpackJsonpakri_dashboard_extension_0_1_0"]||[]).push([[6],{"126f":function(e,t,s){"use strict";var a=function(){var e=this,t=e._self._c;return t("SortableTable",e._g(e._b({ref:"table",attrs:{headers:e._headers,rows:e.filteredRows,loading:e.loading,"group-by":e.computedGroupBy,group:e.group,"group-options":e.groupOptions,search:e.search,paging:!0,"paging-params":e.pagingParams,"paging-label":e.pagingLabel,"row-actions":e.rowActions,"table-actions":e._showBulkActions,"overflow-x":e.overflowX,"overflow-y":e.overflowY,"get-custom-detail-link":e.getCustomDetailLink,"has-advanced-filtering":e.hasAdvancedFiltering,"adv-filter-hide-labels-as-cols":e.advFilterHideLabelsAsCols,"adv-filter-prevent-filtering-labels":e.advFilterPreventFilteringLabels,"key-field":e.keyField,"sort-generation-fn":e.safeSortGenerationFn,"use-query-params-for-simple-filtering":e.useQueryParamsForSimpleFiltering,"force-update-live-and-delayed":e.forceUpdateLiveAndDelayed},on:{clickedActionButton:e.handleActionButtonClick,"group-value-change":function(t){e.group=t}},scopedSlots:e._u([e.showGrouping?{key:"header-middle",fn:function(){return[e._t("more-header-middle"),t("ButtonGroup",{attrs:{options:e.groupOptions},model:{value:e.group,callback:function(t){e.group=t},expression:"group"}})]},proxy:!0}:null,e.showGrouping?{key:"header-right",fn:function(){return[e._t("header-right")]},proxy:!0}:null,{key:"group-by",fn:function({group:e}){return[t("div",{directives:[{name:"clean-html",rawName:"v-clean-html",value:e.ref,expression:"thisGroup.ref"}],staticClass:"group-tab"})]}},e._l(e.$scopedSlots,(function(t,s){return{key:s,fn:function(t){return[e._t(s,null,null,t)]}}})),{key:"shortkeys",fn:function(){return[t("button",{directives:[{name:"shortkey",rawName:"v-shortkey.once",value:["e"],expression:"['e']",modifiers:{once:!0}}],staticClass:"hide",on:{shortkey:function(t){return e.keyAction("edit")}}}),t("button",{directives:[{name:"shortkey",rawName:"v-shortkey.once",value:["y"],expression:"['y']",modifiers:{once:!0}}],staticClass:"hide",on:{shortkey:function(t){return e.keyAction("yaml")}}}),e._showBulkActions?t("button",{directives:[{name:"shortkey",rawName:"v-shortkey.once",value:["del"],expression:"['del']",modifiers:{once:!0}}],staticClass:"hide",on:{shortkey:function(t){return e.keyAction("remove")}}}):e._e(),e._showBulkActions?t("button",{directives:[{name:"shortkey",rawName:"v-shortkey.once",value:["backspace"],expression:"['backspace']",modifiers:{once:!0}}],staticClass:"hide",on:{shortkey:function(t){return e.keyAction("remove")}}}):e._e()]},proxy:!0}],null,!0)},"SortableTable",e.$attrs,!1),e.$listeners))},r=[],o=s("9ce4"),n=s("e24b"),i=s("5000"),l=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"trim-whitespace",rawName:"v-trim-whitespace"}],staticClass:"btn-group"},e._l(e.optionObjects,(function(s,a){return t("button",{directives:[{name:"clean-tooltip",rawName:"v-clean-tooltip",value:s.tooltipKey?e.t(s.tooltipKey):s.tooltip,expression:"opt.tooltipKey ? t(opt.tooltipKey) : opt.tooltip"}],key:a,class:s.class,attrs:{"data-testid":"button-group-child-"+a,type:"button",disabled:e.disabled||s.disabled},on:{click:function(t){return e.change(s.value)}}},[e._t("option",(function(){return[s.icon?t("i",{class:{icon:!0,[s.icon]:!0,["icon-"+e.iconSize]:!!e.iconSize}}):e._e(),s.labelKey?t("t",{attrs:{k:s.labelKey}}):s.label?t("span",[e._v(e._s(s.label))]):e._e()]}),{label:s.label,value:s.value})],2)})),0)},u=[],d={props:{value:{type:[String,Number,Boolean,Object],required:!0},inactiveClass:{type:String,default:"bg-disabled"},activeClass:{type:String,default:"bg-primary"},options:{type:Array,required:!0},iconSize:{type:String,default:null},disabled:{type:Boolean,default:!1}},computed:{optionObjects(){const e=this.value;return this.options.map(t=>{let s;s=t&&"object"===typeof t&&"undefined"!==typeof t.value?Object.assign({},t):{label:t,value:t};const a=e===s.value;return s.class={btn:!0,[this.inactiveClass]:!a,[this.activeClass]:a},s})}},methods:{change(e){this.$emit("input",e)}}},c=d,p=s("d802"),h=Object(p["a"])(c,l,u,!1,null,null,null),b=h.exports,m=s("0fb1"),f=s("462f"),v=s("bddd"),g=s("7083"),y=s("1722");const w="namespace",k=(e,t)=>{var s,a;if(!e)return null;const r=e.id;let o=r;const n=t.getters["currentStore"](r),i=null===(s=(a=t.getters)[n+"/currentGeneration"])||void 0===s?void 0:s.call(a,r);i&&(o+="/"+i);const l=t.getters["activeNamespaceCacheKey"];return l?`${o}/${l}`:o};var _={name:"ResourceTable",components:{ButtonGroup:b,SortableTable:m["b"]},props:{schema:{type:Object,default:null},rows:{type:Array,required:!0},loading:{type:Boolean,required:!1},keyField:{type:String,default:"_key"},headers:{type:Array,default:null},groupBy:{type:String,default:null},namespaced:{type:Boolean,default:null},search:{type:Boolean,default:!0},tableActions:{type:[Boolean,null],default:null},pagingLabel:{type:String,default:"sortableTable.paging.resource"},rowActions:{type:Boolean,default:!0},groupable:{type:Boolean,default:null},groupTooltip:{type:String,default:"resourceTable.groupBy.namespace"},overflowX:{type:Boolean,default:!1},overflowY:{type:Boolean,default:!1},sortGenerationFn:{type:Function,default:null},getCustomDetailLink:{type:Function,default:null},ignoreFilter:{type:Boolean,default:!1},hasAdvancedFiltering:{type:Boolean,default:!1},advFilterHideLabelsAsCols:{type:Boolean,default:!1},advFilterPreventFilteringLabels:{type:Boolean,default:!1},useQueryParamsForSimpleFiltering:{type:Boolean,default:!1},forceUpdateLiveAndDelayed:{type:Number,default:0}},mounted(){window.addEventListener("keyup",this.handleEnterKeyPress)},beforeDestroy(){window.removeEventListener("keyup",this.handleEnterKeyPress)},data(){var e;const t=this.$store.getters["type-map/optionsFor"](this.schema),s=(null===t||void 0===t?void 0:t.listGroups)||[],a=s.reduce((e,t)=>(e[t.value]=t,e),{}),r=null!==(e=this.schema)&&void 0!==e&&e.id?this.$store.getters["currentStore"](this.schema.id):void 0;return{listGroups:s,listGroupMapped:a,inStore:r}},computed:{...Object(o["a"])(["currentProduct"]),isNamespaced(){return null!==this.namespaced?this.namespaced:!!Object(n["f"])(this.schema,"attributes.namespaced")},showNamespaceColumn(){const e="namespace"===this.group,t=!this.showGrouping||!e;return t},_showBulkActions(){if(null!==this.tableActions)return this.tableActions;if(this.schema){const e=this.$store.getters["type-map/hideBulkActionsFor"](this.schema);return!e}return!1},_headers(){var e;let t;const s=this.showNamespaceColumn;if(t=this.headers?this.headers.slice():this.$store.getters["type-map/headersFor"](this.schema),null!==(e=this.$store.$plugin)&&void 0!==e&&e.getUIConfig){const e=Object(y["a"])(this,g["c"].TABLE_COL,g["e"].RESOURCE,this.$route);let s=t.length;if(t.length>0){const e=t.findIndex(e=>e.name===f["b"].name);if(e>=0)s=e;else{const e=t.findIndex(e=>{var t,s;return(!e.label||!(null!==(t=e.label)&&void 0!==t&&t.trim()))&&(!e.labelKey||!(null!==(s=e.labelKey)&&void 0!==s&&s.trim()))});e>=0&&(s=e)}}e.forEach(e=>{!e.value&&e.getValue&&(e.value=e.getValue),t.splice(s,0,e)})}if(!s){const e=t.findIndex(e=>e.name===f["t"].name);e>=0&&t.splice(e,1)}const a=this.listGroupMapped[this.group];if(null!==a&&void 0!==a&&a.hideColumn){const e=t.findIndex(e=>e.name===a.hideColumn);e>=0&&t.splice(e,1)}return t},filteredRows(){var e,t;const s=this.$store.getters["isAllNamespaces"];if(!this.isNamespaced||this.ignoreFilter||s&&(null===(e=this.currentProduct)||void 0===e||!e.hideSystemResources)||this.inStore&&(null===(t=this.$store.getters[this.inStore+"/haveNamespace"](this.schema.id))||void 0===t?void 0:t.length))return this.rows||[];const a=this.$store.getters["namespaces"]();if(!this.rows)return[];const r=this.$store.getters["haveAllNamespace"];return this.rows.filter(e=>{var t;return null!==(t=this.currentProduct)&&void 0!==t&&t.hideSystemResources&&this.isNamespaced?!!a[e.metadata.namespace]&&!e.isSystemResource:!this.isNamespaced||(!!r||!!a[e.metadata.namespace])})},_group:Object(i["k"])(i["e"]),group:{get(){const e=this.groupOptions.find(e=>e.value===this._group);return e?this._group:w},set(e){this._group=e}},showGrouping(){if(null===this.groupable){const e=this.$store.getters["isMultipleNamespaces"]&&this.isNamespaced,t=this.listGroups.length>0;return e||t}return this.groupable||!1},computedGroupBy(){if(this.groupBy)return this.groupBy;if("namespace"===this.group&&this.showGrouping)return"groupByLabel";const e=this.listGroupMapped[this.group];return e&&e.field?e.field:null},groupOptions(){const e=[{tooltipKey:"resourceTable.groupBy.none",icon:"icon-list-flat",value:"none"},{tooltipKey:this.groupTooltip,icon:"icon-folder",value:"namespace"}];return e.concat(this.listGroups)},pagingParams(){return this.schema?{singularLabel:this.$store.getters["type-map/labelFor"](this.schema),pluralLabel:this.$store.getters["type-map/labelFor"](this.schema,99)}:{singularLabel:"",pluralLabel:""}}},methods:{keyAction(e){const t=this.$refs.table;if(!t)return;const s=t.selectedRows;if("remove"!==e){if(1===s.length)switch(e){case"detail":s[0].goToDetail();break;case"edit":s[0].goToEdit();break;case"yaml":s[0].goToViewYaml();break}}else{const e=Object(v["e"])(t.availableActions,"action","promptRemove");e&&(t.setBulkActionOfInterest(e),t.applyTableAction(e))}},clearSelection(){this.$refs.table.clearSelection()},safeSortGenerationFn(){return this.sortGenerationFn?this.sortGenerationFn(this.schema,this.$store):k(this.schema,this.$store)},handleActionButtonClick(e){this.$emit("clickedActionButton",e)},handleEnterKeyPress(e){"Enter"===e.key&&this.keyAction("detail")}}},T=_,S=Object(p["a"])(T,a,r,!1,null,null,null);t["a"]=S.exports},1999:function(e,t,s){"use strict";s("ed65")},"2c3b":function(e,t,s){"use strict";s("ebaf")},ad10:function(e,t,s){var a=s("5eaa");t=a(!1),t.push([e.i,".badge-state[data-v-70e48e16]{align-items:center;display:inline-flex;padding:2px 10px;border:1px solid transparent;border-radius:20px}.badge-state.bg-info[data-v-70e48e16]{border-color:var(--primary)}.badge-state.bg-error[data-v-70e48e16]{border-color:var(--error)}.badge-state.bg-warning[data-v-70e48e16]{border-color:var(--warning)}.badge-state.bg-success[data-v-70e48e16]{color:var(--success);background:transparent;border-color:var(--success)}",""]),e.exports=t},c422:function(e,t,s){"use strict";var a=function(){var e=this,t=e._self._c;return t("Tabbed",e._b({attrs:{"default-tab":e.defaultTab},on:{changed:e.tabChange}},"Tabbed",e.$attrs,!1),[e._t("default"),e.showConditions?t("Tab",{attrs:{"label-key":"resourceTabs.conditions.tab",name:"conditions",weight:-1,"display-alert-icon":e.conditionsHaveIssues}},[t("Conditions",{attrs:{value:e.value}})],1):e._e(),e.showEvents?t("Tab",{attrs:{"label-key":"resourceTabs.events.tab",name:"events",weight:-2}},["events"===e.selectedTab?t("SortableTable",{attrs:{rows:e.events,headers:e.eventHeaders,"key-field":"id",search:!1,"table-actions":!1,"row-actions":!1,"default-sort-by":"date"}}):e._e()],1):e._e(),e.showRelated?t("Tab",{attrs:{name:"related","label-key":"resourceTabs.related.tab",weight:-3}},[t("h3",{directives:[{name:"t",rawName:"v-t",value:"resourceTabs.related.from",expression:"'resourceTabs.related.from'"}]}),t("RelatedResources",{attrs:{"ignore-types":[e.value.type],value:e.value,direction:"from"}}),t("h3",{directives:[{name:"t",rawName:"v-t",value:"resourceTabs.related.to",expression:"'resourceTabs.related.to'"}],staticClass:"mt-20"}),t("RelatedResources",{attrs:{"ignore-types":[e.value.type],value:e.value,direction:"to"}})],1):e._e(),e._l(e.extensionTabs,(function(s,a){return t("Tab",{key:`${s.name}${a}`,attrs:{name:s.name,label:s.label,"label-key":s.labelKey,weight:s.weight,tooltip:s.tooltip,"show-header":s.showHeader,"display-alert-icon":s.displayAlertIcon,error:s.error,badge:s.badge}},[t(s.component,{tag:"component",attrs:{resource:e.value}})],1)}))],2)},r=[],o=s("0cb2"),n=s("38de"),i=s("305c"),l=function(){var e=this,t=e._self._c;return t("SortableTable",{attrs:{headers:e.headers,rows:e.rows,"key-field":"condition","default-sort-by":"condition","table-actions":!1,"row-actions":!1,search:!1},scopedSlots:e._u([{key:"cell:condition",fn:function({row:s}){return[t("span",{class:{"text-error":s.error}},[e._v(e._s(s.condition))])]}},{key:"cell:status",fn:function({row:s}){return[t("span",{class:{"text-error":s.error}},[e._v(e._s(s.status))])]}}])})},u=[],d=s("0fb1"),c={components:{SortableTable:d["b"]},props:{value:{type:Object,default:()=>({})}},computed:{headers(){return[{name:"condition",labelKey:"tableHeaders.condition",value:"condition",width:150,sort:"condition",dashIfEmpty:!0},{name:"status",labelKey:"tableHeaders.status",value:"status",width:75,sort:"status",dashIfEmpty:!0},{name:"time",labelKey:"tableHeaders.updated",value:"time",sort:"time",formatter:"LiveDate",formatterOpts:{addSuffix:!0},width:125,dashIfEmpty:!0},{name:"message",labelKey:"tableHeaders.message",value:"message",sort:["message"],dashIfEmpty:!0}]},rows(){var e;return((null===(e=this.value.status)||void 0===e?void 0:e.conditions)||[]).map(e=>{let t=e.message||"";return e.reason&&(t=`[${e.reason}] ${t}`.trim()),{condition:e.type||"Unknown",status:e.status||"Unknown",error:e.error,time:e.lastProbeTime||e.lastUpdateTime||e.lastTransitionTime,message:t}})}}},p=c,h=s("d802"),b=Object(h["a"])(p,l,u,!1,null,null,null),m=b.exports,f=s("907c"),v=s("da25"),g=function(){var e=this,t=e._self._c;return t("ResourceTable",{attrs:{schema:null,rows:e.rows,headers:e.headers,search:!1,"table-actions":!1,namespaced:!0,"mangle-action-resources":e.getRealResources,"paging-label":"sortableTable.paging.generic",groupable:!1},scopedSlots:e._u([{key:"cell:state",fn:function({row:e}){return[e.real?t("BadgeState",{attrs:{value:e.real}}):t("BadgeState",{attrs:{value:e}})]}}])})},y=[],w=s("126f"),k=s("9c09"),_=s("462f"),T=s("1d19"),S=s("bcb3"),$=function(){var e=this,t=e._self._c;e._self._setupProxy;return t("span",{class:{"badge-state":!0,[e.bg]:!0}},[e.icon?t("i",{staticClass:"icon",class:{[e.icon]:!0,"mr-5":!!e.msg}}):e._e(),e._v(e._s(e.msg)+" ")])},x=[],B=s("8bbf"),A=s.n(B),C=A.a.extend({props:{value:{type:Object,default:null},color:{type:String,default:null},icon:{type:String,default:null},label:{type:String,default:null}},computed:{bg(){var e;return(null===(e=this.value)||void 0===e?void 0:e.stateBackground)||this.color},msg(){var e;return(null===(e=this.value)||void 0===e?void 0:e.stateDisplay)||this.label}}}),O=C,R=(s("1999"),s("2c3b"),Object(h["a"])(O,$,x,!1,null,"70e48e16",null)),F=R.exports,E={components:{ResourceTable:w["a"],BadgeState:F},props:{value:{type:Object,required:!0},rel:{type:String,default:null},direction:{type:String,default:"to"},ignoreTypes:{type:Array,default:()=>[]}},data(){return{loadedResources:1}},computed:{filteredRelationships(){var e;let t=(null===(e=this.value)||void 0===e||null===(e=e.metadata)||void 0===e?void 0:e.relationships)||[];return t=t.filter(e=>{const t=e[this.direction+"Type"];return!(!t||this.ignoreTypes.includes(t))&&(!this.rel||e.rel===this.rel)}),t},rows(){if(this.loadedResources<1)return;const e=this.$store.getters["clusterId"],t=this.$store.getters["currentStore"](),s=[];for(const a of this.filteredRelationships){const r=a.state||"active",o=Object(k["b"])(r,a.error,a.transitioning),n=a[this.direction+"Type"],i=this.$store.getters[t+"/schemaFor"](n);let l=a[this.direction+"Id"];if(!l)continue;let u=null;const d=l.indexOf("/"),c=`${n}/${u}/${l}`;d>0&&(u=l.substr(0,d),l=l.substr(d+1));const p={name:`c-cluster-product-resource${u?"-namespace":""}-id`,params:{product:S["a"],cluster:"management"===t?"local":e,resource:n,namespace:u,id:l}};s.push({type:n,real:this.$store.getters[t+"/byId"](n,a[this.direction+"Id"]),id:a[this.direction+"Id"],state:r,metadata:{namespace:u,name:l},_key:c,name:l,namespace:u,nameDisplay:l,nameSort:Object(T["b"])(l).toLowerCase(),stateColor:o,detailLocation:p,typeDisplay:this.$store.getters["type-map/labelFor"](i),stateDisplay:Object(k["e"])(r),stateBackground:o.replace("text-","bg-"),groupByLabel:u})}return s},headers(){return[_["H"],_["M"],_["s"],_["t"]]}},methods:{async getRealResources(e){const t=this.$store.getters["currentStore"](),s=await Promise.allSettled(e.map(e=>this.$store.dispatch(t+"/find",{type:e.type,id:e.id}))),a=[];for(let r=0;r<s.length;r++)"fulfilled"===s[r].status&&a.push(s[r].value);return this.loadedResources++,a}}},j=E,L=Object(h["a"])(j,g,y,!1,null,null,null),N=L.exports,G=s("7083"),I=s("1722"),K={name:"ResourceTabs",components:{Tabbed:o["a"],Tab:n["a"],Conditions:m,SortableTable:d["b"],RelatedResources:N},mixins:[i["a"]],props:{value:{type:Object,default:()=>({})},mode:{type:String,default:v["r"]},defaultTab:{type:String,default:null},needConditions:{type:Boolean,default:!0},needEvents:{type:Boolean,default:!0},needRelated:{type:Boolean,default:!0},extensionParams:{type:Object,default:null}},data(){const e=this.$store.getters["currentStore"](f["f"]);return{hasEvents:this.$store.getters[e+"/schemaFor"](f["f"]),allEvents:[],selectedTab:this.defaultTab,didLoadEvents:!1,extensionTabs:Object(I["a"])(this,G["c"].TAB,G["d"].RESOURCE_DETAIL,this.$route,this,this.extensionParams)}},beforeDestroy(){this.$store.dispatch("cluster/forgetType",f["f"])},computed:{showConditions(){const e=this.$store.getters["currentStore"](this.value.type);var t;return!!this.$store.getters[e+"/schemaFor"](this.value.type)&&(this.isView&&this.needConditions&&(null===(t=this.value)||void 0===t?void 0:t.type)&&this.$store.getters[e+"/pathExistsInSchema"](this.value.type,"status.conditions"))},showEvents(){return this.isView&&this.needEvents&&this.hasEvents},showRelated(){return this.isView&&this.needRelated},eventHeaders(){return[{name:"type",label:this.t("tableHeaders.type"),value:"eventType",sort:"eventType"},{name:"reason",label:this.t("tableHeaders.reason"),value:"reason",sort:"reason"},{name:"date",label:this.t("tableHeaders.updated"),value:"date",sort:"date:desc",formatter:"LiveDate",formatterOpts:{addSuffix:!0},width:125},{name:"message",label:this.t("tableHeaders.message"),value:"message",sort:"message"}]},events(){return this.allEvents.filter(e=>{var t,s;return(null===(t=e.involvedObject)||void 0===t?void 0:t.uid)===(null===(s=this.value)||void 0===s||null===(s=s.metadata)||void 0===s?void 0:s.uid)}).map(e=>({reason:`${e.reason||this.t("generic.unknown")}${e.count>1?` (${e.count})`:""}`.trim(),message:e.message||this.t("generic.unknown"),date:e.lastTimestamp||e.firstTimestamp||e.metadata.creationTimestamp,eventType:e.eventType}))},conditionsHaveIssues(){var e;return!!this.showConditions&&(null===(e=this.value.status)||void 0===e||null===(e=e.conditions)||void 0===e?void 0:e.filter(e=>!Object(k["d"])(e)).some(e=>e.error))}},methods:{tabChange(e){if(this.selectedTab=null===e||void 0===e?void 0:e.selectedName,!this.didLoadEvents&&"events"===this.selectedTab){const e=this.$store.getters["currentStore"](f["f"]);this.$store.dispatch(e+"/findAll",{type:f["f"]}).then(e=>{this.allEvents=e,this.didLoadEvents=!0})}}}},P=K,H=Object(h["a"])(P,a,r,!1,null,null,null);t["a"]=H.exports},e0bb:function(e,t,s){var a=s("5eaa");t=a(!1),t.push([e.i,".sortable-table TD .badge-state{text-overflow:ellipsis;overflow:hidden;white-space:nowrap;word-wrap:break-word;display:inline-block;max-width:100%;position:relative;max-width:110px;font-size:.85em;vertical-align:middle}",""]),e.exports=t},ebaf:function(e,t,s){var a=s("e0bb");a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);var r=s("0ed3").default;r("68150618",a,!0,{sourceMap:!1,shadowMode:!1})},ed65:function(e,t,s){var a=s("ad10");a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);var r=s("0ed3").default;r("31e7c4ea",a,!0,{sourceMap:!1,shadowMode:!1})}}]);
//# sourceMappingURL=akri-dashboard-extension-0.1.0.umd.min.vendors~detail.js.map